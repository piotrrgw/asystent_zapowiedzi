<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sufler Konduktora 5.0 (FINAL)</title>
    <style>
        /* RESET I BAZA */
        * { box-sizing: border-box; }
        body {
            font-family: sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f2f5;
            color: #1c1e21;
            padding-bottom: 50px; /* Miejsce na scroll */
        }

        /* NAG≈Å√ìWEK */
        header {
            background-color: #003366; /* PKP Blue */
            color: white;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .settings-btn {
            background: #ff6a00; /* PKP Orange */
            border: none;
            color: white;
            padding: 8px 15px;
            border-radius: 5px;
            font-weight: bold;
            font-size: 14px;
        }

        /* KONTENERY */
        .container { padding: 10px; }
        
        .section-header {
            font-size: 12px;
            text-transform: uppercase;
            color: #606770;
            font-weight: bold;
            margin: 15px 0 5px 5px;
            border-bottom: 1px solid #ccc;
        }

        /* PRZYCISKI G≈Å√ìWNE */
        .grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
        }
        
        .btn {
            background: white;
            border: 1px solid #ddd;
            border-left: 5px solid #003366;
            padding: 15px;
            border-radius: 8px;
            text-align: left;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            font-size: 16px;
            font-weight: bold;
            color: #003366;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .btn:active { background-color: #e4e6eb; transform: scale(0.98); }
        .btn small { display: block; font-weight: normal; color: #666; font-size: 12px; margin-top: 3px; }
        .arrow { font-size: 20px; color: #ccc; }

        /* Specjalne kolory dla grup */
        .btn.delay { border-left-color: #d32f2f; color: #d32f2f; }
        .btn.other { border-left-color: #555; color: #333; }

        /* PANELE (MODALE) */
        .fullscreen-panel {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: white;
            z-index: 200;
            display: none; /* Domy≈õlnie ukryte */
            flex-direction: column;
        }
        .fullscreen-panel.active { display: flex; }

        .panel-header {
            background: #f0f2f5;
            padding: 15px;
            border-bottom: 1px solid #ddd;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: bold;
        }

        .panel-content {
            padding: 20px;
            overflow-y: auto;
            flex: 1;
        }

        /* FORMULARZE */
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; font-size: 14px; }
        input, select {
            width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 5px; font-size: 16px;
        }
        .checkbox-wrapper {
            display: flex; align-items: center; gap: 10px; background: #eef; padding: 10px; border-radius: 5px;
        }

        /* WYNIK (Output) */
        .output-text {
            font-family: "Times New Roman", serif;
            font-size: 18px;
            line-height: 1.5;
            white-space: pre-wrap;
        }
        .en-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #ccc;
            font-style: italic;
            color: #444;
        }

    </style>
</head>
<body>

<header>
    <div>SUFLER PKP IC</div>
    <button class="settings-btn" onclick="openSettings()">USTAWIENIA</button>
</header>

<div class="container">

    <div class="section-header">Komunikaty Podstawowe</div>
    <div class="grid">
        <button class="btn" onclick="runPattern(1)">
            <div>
                1. POWITALNY ‚Äì SKR√ìCONY STARTOWY
                <small>W mie≈õcie rozpoczƒôcia biegu</small>
            </div>
            <span class="arrow">‚û§</span>
        </button>

        <button class="btn" onclick="runPattern(2)">
            <div>
                2. POWITALNY ‚Äì ROZSZERZONY
                <small>Po wyje≈∫dzie z wƒôz≈Ça / Pe≈Çny</small>
            </div>
            <span class="arrow">‚û§</span>
        </button>

        <button class="btn" onclick="runPattern(3)">
            <div>
                3. POWITALNY ‚Äì SKR√ìCONY
                <small>Na trasie (po zwyk≈Çej stacji)</small>
            </div>
            <span class="arrow">‚û§</span>
        </button>

        <button class="btn" onclick="runPattern(4)">
            <div>
                4. POWITALNO-PO≈ªEGNALNY
                <small>Skr√≥cony / Tranzytowy / Lotniska</small>
            </div>
            <span class="arrow">‚û§</span>
        </button>

        <button class="btn" onclick="runPattern(5)">
            <div>
                5. PO≈ªEGNALNY
                <small>Stacja ko≈Ñcowa / Przesiadki</small>
            </div>
            <span class="arrow">‚û§</span>
        </button>
    </div>

    <div class="section-header">Op√≥≈∫nienia i Inne</div>
    <div class="grid">
        <button class="btn delay" onclick="openDelayPanel()">
            <div>
                ‚è±Ô∏è ZG≈ÅO≈ö OP√ì≈πNIENIE
                <small>Wybierz przyczynƒô z listy</small>
            </div>
            <span class="arrow">‚û§</span>
        </button>
        
        <button class="btn other" onclick="simpleMsg('toalety')">
            <div>üöΩ ZAMKNIƒòCIE TOALET</div>
        </button>
        
        <button class="btn other" onclick="simpleMsg('zakaz')">
            <div>üö≠ ZAKAZ PALENIA</div>
        </button>
    </div>

</div>

<div id="settingsPanel" class="fullscreen-panel active">
    <div class="panel-header">
        <span>KONFIGURACJA POCIƒÑGU</span>
        <button onclick="closeSettings()" style="background:none;border:none;font-weight:bold;color:#003366;">ZAPISZ ‚úï</button>
    </div>
    <div class="panel-content">
        <div class="form-group">
            <label>Kategoria:</label>
            <select id="trainCat">
                <option value="IC">IC</option>
                <option value="TLK">TLK</option>
                <option value="EIC">EIC</option>
                <option value="EIP">EIP (Pendolino)</option>
            </select>
        </div>
        <div class="form-group">
            <label>Numer pociƒÖgu:</label>
            <input type="text" id="trainNr" placeholder="np. 13100">
        </div>
        <div class="form-group">
            <label>Nazwa pociƒÖgu (opcjonalnie):</label>
            <input type="text" id="trainName" placeholder="np. MALINOWSKI">
        </div>
        <div class="form-group checkbox-wrapper">
            <input type="checkbox" id="isIntl">
            <label for="isIntl">PociƒÖg Miƒôdzynarodowy (Jƒôzyk Angielski)</label>
        </div>
        <hr>
        <div class="form-group">
            <label>Relacja Z:</label>
            <input type="text" id="stStart" placeholder="Stacja poczƒÖtkowa">
        </div>
        <div class="form-group">
            <label>Relacja DO:</label>
            <input type="text" id="stEnd" placeholder="Stacja ko≈Ñcowa">
        </div>
        <div class="form-group">
            <label>Przez (opcjonalnie):</label>
            <input type="text" id="stVia" placeholder="Wa≈ºna stacja po≈õrednia">
        </div>
        <hr>
        <div class="form-group">
            <label>Nr wagonu dru≈ºyny:</label>
            <input type="text" id="crewCar" placeholder="np. 14">
        </div>
        <div class="form-group">
            <label>Gastronomia:</label>
            <select id="gastroType">
                <option value="WARS">Wagon WARS</option>
                <option value="VENDING">Automaty</option>
                <option value="TROLLEY">W√≥zek</option>
                <option value="NONE">Brak</option>
            </select>
        </div>
        <div class="form-group">
            <label>Nr wagonu gastronomicznego:</label>
            <input type="text" id="gastroCar" placeholder="np. 12">
        </div>
        
        <button onclick="closeSettings()" style="width:100%; padding:15px; background:#003366; color:white; border:none; border-radius:5px; margin-top:20px; font-weight:bold;">ZATWIERD≈π DANE</button>
    </div>
</div>

<div id="resultPanel" class="fullscreen-panel">
    <div class="panel-header">
        <span>TWOJA TRE≈öƒÜ:</span>
        <button onclick="closeResult()" style="font-size:24px; background:none; border:none;">‚úï</button>
    </div>
    <div class="panel-content">
        <div id="finalText" class="output-text"></div>
        <button onclick="closeResult()" style="width:100%; padding:15px; background:#ddd; border:none; border-radius:5px; margin-top:20px;">ZAMKNIJ</button>
    </div>
</div>

<div id="delayPanel" class="fullscreen-panel">
    <div class="panel-header">
        <span>WYBIERZ PRZYCZYNƒò</span>
        <button onclick="closeDelayPanel()" style="font-size:24px; background:none; border:none;">‚úï</button>
    </div>
    <div class="panel-content">
        <label>Przyczyna (wg Za≈ÇƒÖcznika 1):</label>
        <select id="delayReason" style="margin-bottom:15px;"></select>
        
        <label>Ile minut op√≥≈∫nienia?</label>
        <input type="number" id="delayMinutes" value="10" style="margin-bottom:20px;">
        
        <button onclick="generateDelayMsg()" style="width:100%; padding:15px; background:#d32f2f; color:white; border:none; border-radius:5px; font-weight:bold;">GENERUJ KOMUNIKAT</button>
    </div>
</div>

<script>
    // --- BAZA DANYCH ---
    
    // Lista przyczyn op√≥≈∫nie≈Ñ
    const reasons = [
        {id: "1", txt: "awariƒÖ taboru", en: "a rolling stock failure"},
        {id: "2", txt: "naprawƒÖ drzwi", en: "the repairment of the rolling stock"},
        {id: "5", txt: "wypadkiem", en: "an accident"},
        {id: "6", txt: "wypadkiem z udzia≈Çem cz≈Çowieka", en: "an accident involving a human being"},
        {id: "11", txt: "trudnymi warunkami atmosferycznymi", en: "bad weather conditions"},
        {id: "23", txt: "awariƒÖ sieci trakcyjnej", en: "malfunction of overhead wiring"},
        {id: "29", txt: "awariƒÖ sterowania ruchem", en: "malfunction of traffic control"},
        {id: "20", txt: "skomunikowaniem (oczekiwaniem)", en: "waiting for another train"},
        {id: "99", txt: "przyczynami technicznymi", en: "technical reasons"}
    ];

    // Lista lotnisk (klucz to nazwa stacji ma≈Çymi literami)
    const airports = {
        "warszawa centralna": {pl: "Lotniska Chopina", en: "Chopin Airport"},
        "warszawa wschodnia": {pl: "Lotniska Chopina", en: "Chopin Airport"},
        "warszawa zachodnia": {pl: "Lotniska Chopina", en: "Chopin Airport"},
        "warszawa gda≈Ñska": {pl: "Lotniska Modlin", en: "Modlin Airport"},
        "krak√≥w g≈Ç√≥wny": {pl: "Portu Lotniczego Krak√≥w-Balice", en: "Krakow Airport"},
        "gdansk wrzeszcz": {pl: "Portu Lotniczego Gda≈Ñsk", en: "Gdansk Airport"},
        "gdynia g≈Ç√≥wna": {pl: "Portu Lotniczego Gda≈Ñsk", en: "Gdansk Airport"},
        "katowice": {pl: "Portu Lotniczego Pyrzowice", en: "Katowice Airport"},
        "wroc≈Çaw g≈Ç√≥wny": {pl: "Portu Lotniczego Wroc≈Çaw", en: "Wroclaw Airport"},
        "szczecin dƒÖbie": {pl: "Portu Lotniczego Goleni√≥w", en: "Szczecin Airport"},
        "lublin g≈Ç√≥wny": {pl: "Portu Lotniczego Lublin", en: "Lublin Airport"}
    };

    // --- LOGIKA UI ---

    function openSettings() { document.getElementById('settingsPanel').classList.add('active'); }
    function closeSettings() { document.getElementById('settingsPanel').classList.remove('active'); }
    
    function closeResult() { document.getElementById('resultPanel').classList.remove('active'); }
    
    function openDelayPanel() {
        const sel = document.getElementById('delayReason');
        sel.innerHTML = "";
        reasons.forEach(r => {
            let opt = document.createElement('option');
            opt.value = r.id;
            opt.innerText = r.id + ". " + r.txt;
            sel.appendChild(opt);
        });
        document.getElementById('delayPanel').classList.add('active');
    }
    function closeDelayPanel() { document.getElementById('delayPanel').classList.remove('active'); }

    // --- POBIERANIE DANYCH ---

    function getD() {
        return {
            cat: document.getElementById('trainCat').value,
            nr: document.getElementById('trainNr').value || "XXXX",
            name: document.getElementById('trainName').value,
            start: document.getElementById('stStart').value || "...",
            end: document.getElementById('stEnd').value || "...",
            via: document.getElementById('stVia').value,
            crew: document.getElementById('crewCar').value || "..",
            gastro: document.getElementById('gastroType').value,
            gastroNr: document.getElementById('gastroCar').value || "..",
            en: document.getElementById('isIntl').checked || document.getElementById('trainCat').value === 'EIP'
        };
    }

    function getFullCat(c) {
        if(c==='EIP') return "Express Intercity Premium";
        if(c==='EIC') return "Express Intercity";
        if(c==='IC') return "Intercity";
        return "TLK";
    }

    function getHello(en) {
        const h = new Date().getHours();
        if(!en) return h < 18 ? "Dzie≈Ñ dobry!" : "Dobry wiecz√≥r!";
        if(h<12) return "Good morning!";
        if(h<18) return "Good afternoon!";
        return "Good evening!";
    }

    function checkAir(station) {
        if(!station) return null;
        let s = station.toLowerCase().trim();
        for(let key in airports) {
            if(s.includes(key)) return airports[key];
        }
        return null;
    }

    // --- GENERATORY TRE≈öCI ---

    function runPattern(num) {
        const d = getD();
        let txt = "";

        // WZ√ìR 1 - STARTOWY
        if(num === 1) {
            let next = prompt("Podaj nastƒôpnƒÖ stacjƒô:");
            if(!next) return;
            txt += `Nastƒôpna stacja: ${next}.\n`;
            if(confirm("Czy jest op√≥≈∫nienie >5 min?")) txt += `Przepraszamy za op√≥≈∫nienie pociƒÖgu.\n`;
            if(d.gastro !== 'NONE') txt += `Zapraszamy do skorzystania z oferty gastronomicznej.`;
            
            if(d.en) {
                txt += `\n\n<div class="en-section">Next station: ${next}.\n`;
                if(txt.includes("Przepraszamy")) txt += `We apologize for the delay.\n`;
                txt += `</div>`;
            }
        }

        // WZ√ìR 2 - ROZSZERZONY (PE≈ÅNY)
        if(num === 2) {
            txt += `${getHello(false)}\n`;
            let n = d.name ? ` "${d.name}"` : "";
            let v = d.via ? `, przez stacjƒô ${d.via}` : "";
            txt += `Witamy w pociƒÖgu ${getFullCat(d.cat)} numer ${d.nr}${n} ze stacji ${d.start} do stacji ${d.end}${v}.\n\n`;
            
            let next = prompt("Nastƒôpna stacja (opcjonalnie - ENTER by pominƒÖƒá):");
            if(next) txt += `Nastƒôpna stacja: ${next}.\n\n`;

            txt += `W trosce o Pa≈Ñstwa komfort i bezpiecze≈Ñstwo, prosimy o zapoznanie siƒô z informacjami zamieszczonymi w wagonach.\n`;
            txt += `Dru≈ºyna konduktorska pozostaje do Pa≈Ñstwa dyspozycji. Przedzia≈Ç konduktorski znajduje siƒô w wagonie numer ${d.crew}.\n\n`;

            if(d.gastro === 'WARS') txt += `Zapraszamy do skorzystania z oferty WARS w wagonie ${d.gastroNr}.`;
            else if(d.gastro === 'VENDING') txt += `Zapraszamy do automat√≥w w wagonie ${d.gastroNr}.`;
            else if(d.gastro === 'NONE') txt += `Informujemy, ≈ºe oferta gastronomiczna nie jest dostƒôpna.`;

            if(d.en) {
                txt += `\n\n<div class="en-section">${getHello(true)}\n`;
                txt += `Welcome on board of our train from ${d.start} to ${d.end}.\n`;
                if(next) txt += `Next station: ${next}.\n`;
                txt += `The train crew remains at your service in car number ${d.crew}.\n`;
                txt += `</div>`;
            }
        }

        // WZ√ìR 3 - SKR√ìCONY NA TRASIE
        if(num === 3) {
            let next = prompt("Nastƒôpna stacja:");
            if(!next) return;
            txt += `Nastƒôpna stacja: ${next}.\n`;
            if(confirm("Czy dodaƒá info o op√≥≈∫nieniu?")) {
                txt += `Przepraszamy za op√≥≈∫nienie. Osoby przesiadajƒÖce siƒô prosimy o kontakt z dru≈ºynƒÖ konduktorskƒÖ.\n`;
            }
            if(d.en) {
                txt += `\n\n<div class="en-section">Next station: ${next}.\n`;
                if(txt.includes("Przepraszamy")) txt += `We apologize for the delay.\n`;
                txt += `</div>`;
            }
        }

        // WZ√ìR 4 - TRANZYTOWY (LOTNISKA)
        if(num === 4) {
            let st = prompt("Zbli≈ºamy siƒô do stacji:");
            if(!st) return;
            txt += `Zbli≈ºamy siƒô do stacji ${st}.\n`;
            
            let dep = prompt("Godzina odjazdu (opcjonalnie):");
            if(dep) txt += `Planowy odjazd o godzinie ${dep}.\n`;

            txt += `Osoby wysiadajƒÖce prosimy o zabranie rzeczy. Dziƒôkujemy za podr√≥≈º.\n`;

            // Auto-Lotnisko
            let air = checkAir(st);
            if(air) {
                txt += `\nZe stacji ${st} odje≈ºd≈ºajƒÖ pociƒÖgi w kierunku ${air.pl}.\n`;
            }

            if(d.en) {
                txt += `\n\n<div class="en-section">We are approaching ${st}.\n`;
                txt += `Please remember to take your belongings.\n`;
                if(air) txt += `From here depart trains to ${air.en}.\n`;
                txt += `</div>`;
            }
        }

        // WZ√ìR 5 - PO≈ªEGNALNY
        if(num === 5) {
            let st = d.end; 
            txt += `Zbli≈ºamy siƒô do stacji ko≈Ñcowej ${st}.\n`;
            txt += `Osoby wysiadajƒÖce prosimy o zabranie rzeczy. Dziƒôkujemy za podr√≥≈º z PKP Intercity.\n`;
            
            let air = checkAir(st);
            if(air) txt += `\nMo≈ºliwo≈õƒá przesiadki na pociƒÖg do ${air.pl}.`;

            if(d.en) {
                txt += `\n\n<div class="en-section">We are approaching the terminal station ${st}.\n`;
                txt += `Thank you for choosing PKP Intercity.\n`;
                txt += `</div>`;
            }
        }

        showText(txt);
    }

    // GENERATOR OP√ì≈πNIE≈É
    function generateDelayMsg() {
        const id = document.getElementById('delayReason').value;
        const min = document.getElementById('delayMinutes').value;
        const r = reasons.find(x => x.id === id);
        const d = getD();

        let txt = `Informujemy, ≈ºe w zwiƒÖzku z ${r.txt} pociƒÖg jest op√≥≈∫niony o ${min} minut.\n`;
        txt += `Przepraszamy za op√≥≈∫nienie.\n`;
        txt += `Osoby przesiadajƒÖce siƒô prosimy o zg≈Çaszanie tego dru≈ºynie konduktorskiej w wagonie ${d.crew}.`;

        if(d.en) {
            txt += `\n\n<div class="en-section">Due to ${r.en} the train is delayed about ${min} minutes.\n`;
            txt += `We apologize for the delay. Please report connections to the train crew.</div>`;
        }

        closeDelayPanel();
        showText(txt);
    }

    // INNE PROSTE
    function simpleMsg(type) {
        let txt = "";
        const d = getD();
        if(type === 'toalety') {
            txt = "Informujemy, ≈ºe na najbli≈ºszym odcinku toalety bƒôdƒÖ zamkniƒôte. Przepraszamy.";
            if(d.en) txt += `\n\n<div class="en-section">Toilets will be closed on this section. Sorry for inconvenience.</div>`;
        }
        if(type === 'zakaz') {
            txt = "Przypominamy o ca≈Çkowitym zakazie palenia i spo≈ºywania alkoholu w pociƒÖgu.";
            if(d.en) txt += `\n\n<div class="en-section">Smoking and drinking alcohol is strictly prohibited.</div>`;
        }
        showText(txt);
    }

    function showText(t) {
        document.getElementById('finalText').innerHTML = t;
        document.getElementById('resultPanel').classList.add('active');
    }

</script>
</body>
</html>