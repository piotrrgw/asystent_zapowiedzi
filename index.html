<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sufler Konduktora PKP IC (Wz√≥r 2025)</title>
    <style>
        :root {
            --pkp-orange: #ff6a00;
            --pkp-blue: #003366;
            --pkp-grey: #f0f0f0;
            --text-dark: #333;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--pkp-grey);
            color: var(--text-dark);
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* --- HEADER & SETTINGS --- */
        header {
            background-color: var(--pkp-blue);
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .settings-panel {
            background: white;
            padding: 20px;
            border-bottom: 2px solid var(--pkp-orange);
            display: none;
            overflow-y: auto;
            max-height: 80vh;
        }

        .settings-panel.active {
            display: block;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 6px;
            font-size: 0.9em;
            color: #444;
            font-weight: 500;
        }

        select, input[type="text"], input[type="number"] {
            width: 100%;
            padding: 12px;
            border: 1px solid #ccc;
            border-radius: 8px;
            font-size: 16px;
            box-sizing: border-box;
            background: #fff;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-top: 10px;
            background: #eef;
            padding: 10px;
            border-radius: 8px;
        }

        .checkbox-group input {
            width: 22px;
            height: 22px;
        }

        /* --- MAIN GRID --- */
        .grid-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            padding: 15px;
            flex-grow: 1;
            align-content: start;
            overflow-y: auto;
        }

        .btn {
            background: white;
            border: none;
            padding: 25px 10px;
            border-radius: 16px;
            font-size: 15px;
            font-weight: 700;
            color: var(--pkp-blue);
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            cursor: pointer;
            transition: transform 0.1s, background 0.2s;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            border: 1px solid #eee;
        }

        .btn:active {
            transform: scale(0.96);
            background: #f8f9fa;
        }

        .btn.primary {
            background-color: var(--pkp-blue);
            color: white;
            grid-column: span 2;
        }

        .btn.alert {
            background-color: #d32f2f;
            color: white;
        }

        .btn i {
            font-size: 28px;
            margin-bottom: 10px;
            display: block;
        }

        /* --- OUTPUT MODAL --- */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            z-index: 1000;
            display: none;
            flex-direction: column;
        }

        .modal.active {
            display: flex;
        }

        .modal-header {
            background: var(--pkp-grey);
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #ccc;
        }

        .modal-content {
            padding: 25px;
            overflow-y: auto;
            flex-grow: 1;
            font-family: "Times New Roman", Times, serif; /* Wym√≥g PDF */
            font-size: 18px; /* Czytelno≈õƒá */
            line-height: 1.6;
            white-space: pre-wrap;
            color: #000;
        }

        .en-text {
            color: #444;
            font-style: italic;
            margin-top: 20px;
            border-top: 1px solid #ccc;
            padding-top: 20px;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 28px;
            color: var(--pkp-blue);
            cursor: pointer;
            padding: 0 10px;
        }

        .hidden { display: none; }
    </style>
</head>
<body>

<header>
    <div>SUFLER PKP IC</div>
    <div onclick="toggleSettings()" style="cursor: pointer; font-size: 0.9em;">‚öôÔ∏è USTAWIENIA</div>
</header>

<div id="settings" class="settings-panel active">
    <h3>Dane PociƒÖgu (Wype≈Çnij raz)</h3>
    
    <div class="form-group">
        <label>Kategoria i Numer:</label>
        <div style="display: flex; gap: 5px;">
            <select id="trainCategory" style="flex: 1;" onchange="updateInterface()">
                <option value="IC">IC</option>
                <option value="TLK">TLK</option>
                <option value="EIC">EIC</option>
                <option value="EIP">EIP (Pendolino)</option>
            </select>
            <input type="text" id="trainNumber" placeholder="Nr (np. 1234)" style="flex: 1;">
        </div>
    </div>
    
    <div class="form-group">
        <label>Nazwa pociƒÖgu (opcjonalnie):</label>
        <input type="text" id="trainName" placeholder="np. MA≈ÅOPOLSKA">
    </div>

    <div class="checkbox-group form-group">
        <input type="checkbox" id="isInternational" onchange="updateInterface()">
        <label for="isInternational">PociƒÖg Miƒôdzynarodowy (EN)</label>
    </div>

    <div class="form-group">
        <label>Relacja:</label>
        <input type="text" id="stationStart" placeholder="Z: Warszawa Wsch." style="margin-bottom: 5px;">
        <input type="text" id="stationEnd" placeholder="Do: Wroc≈Çaw G≈Ç." style="margin-bottom: 5px;">
        <input type="text" id="stationVia" placeholder="Przez: (opcjonalnie)">
    </div>

    <div class="form-group">
        <label>Nr wagonu z dru≈ºynƒÖ (Do komunikatu!):</label>
        <input type="number" id="conductorCar" placeholder="np. 12">
    </div>
    
    <div class="form-group">
        <label>Gastronomia:</label>
        <select id="gastronomyType" onchange="updateGastroFields()">
            <option value="WARS">Wagon Gastronomiczny (WARS)</option>
            <option value="VENDING">Automaty (Vending)</option>
            <option value="TROLLEY">W√≥zek Mini-bar</option>
            <option value="NONE">Brak oferty</option>
        </select>
    </div>

    <div class="form-group" id="gastroCarDiv">
        <label>Nr wagonu gastronomicznego/automat√≥w:</label>
        <input type="text" id="gastroCar" placeholder="np. 10">
    </div>

    <button class="btn primary" style="width: 100%; grid-column: auto; padding: 15px;" onclick="toggleSettings()">ZAPISZ DANE</button>
</div>

<div class="grid-container">
    <button class="btn primary" onclick="generateWelcome()">
        <i>üì¢</i> POWITANIE<br><small>(Wz√≥r 2 - Rozszerzony)</small>
    </button>

    <button class="btn" onclick="generateStation()">
        <i>üöâ</i> NASTƒòPNA<br>STACJA
    </button>

    <button class="btn" onclick="openDelayMenu()">
        <i>‚è±Ô∏è</i> OP√ì≈πNIENIE<br><small>(Katalog)</small>
    </button>

    <button class="btn" onclick="generateFarewell()">
        <i>üëã</i> PO≈ªEGNANIE<br><small>(Wz√≥r 5)</small>
    </button>

     <button class="btn alert" onclick="generateEmergency()">
        <i>‚ö†Ô∏è</i> AWARIA /<br>POST√ìJ
    </button>
</div>

<div id="outputModal" class="modal">
    <div class="modal-header">
        <span>KOMUNIKAT 1:1 Z PDF</span>
        <button class="close-btn" onclick="closeModal()">‚úï</button>
    </div>
    <div id="outputText" class="modal-content"></div>
</div>

<script>
    // S≈ÅOWNIKI ZGODNE Z PDF (ZA≈ÅƒÑCZNIK 1)
    const delayReasons = {
        "tabor": "awariƒÖ taboru",
        "drzwi": "naprawƒÖ drzwi w sk≈Çadzie",
        "siec": "awariƒÖ sieci trakcyjnej",
        "pogoda": "trudnymi warunkami atmosferycznymi",
        "wypadek_czlowiek": "wypadkiem z udzia≈Çem cz≈Çowieka",
        "wypadek_przejazd": "wypadkiem na przeje≈∫dzie kolejowym",
        "sterowanie": "awariƒÖ urzƒÖdze≈Ñ sterowania ruchem kolejowym",
        "skrzyzowanie": "przepuszczaniem innego pociƒÖgu",
        "inne": "przyczynami technicznymi"
    };

    const delayReasonsEn = {
        "tabor": "a rolling stock failure",
        "drzwi": "the repairment of the rolling stock",
        "siec": "the malfunction of the railway overhead wiring",
        "pogoda": "the bad weather conditions",
        "wypadek_czlowiek": "an accident involving a human being",
        "wypadek_przejazd": "an accident on a railway crossing",
        "sterowanie": "the malfunction of the railway traffic control device",
        "skrzyzowanie": "allowing another train to pass",
        "inne": "technical reasons"
    };

    // --- FUNKCJE POMOCNICZE ---

    function toggleSettings() {
        document.getElementById('settings').classList.toggle('active');
    }

    function updateGastroFields() {
        const type = document.getElementById('gastronomyType').value;
        const div = document.getElementById('gastroCarDiv');
        // Ukryj pole numeru wagonu je≈õli wybrano "Brak" lub "W√≥zek" (chyba ≈ºe w√≥zek stacjonarny, ale PDF m√≥wi o przemieszczaniu)
        if (type === 'NONE' || type === 'TROLLEY') {
            div.style.display = 'none';
        } else {
            div.style.display = 'block';
        }
    }

    function isEnglishRequired() {
        const cat = document.getElementById('trainCategory').value;
        const isIntl = document.getElementById('isInternational').checked;
        return cat === 'EIP' || isIntl;
    }

    function getData() {
        return {
            cat: document.getElementById('trainCategory').value,
            catFull: getCatFullName(document.getElementById('trainCategory').value),
            nr: document.getElementById('trainNumber').value || "...",
            name: document.getElementById('trainName').value, // mo≈ºe byƒá puste
            start: document.getElementById('stationStart').value || "...",
            end: document.getElementById('stationEnd').value || "...",
            via: document.getElementById('stationVia').value,
            crewCar: document.getElementById('conductorCar').value || "...",
            gastroType: document.getElementById('gastronomyType').value,
            gastroCar: document.getElementById('gastroCar').value || "..."
        };
    }

    function getCatFullName(cat) {
        if(cat === 'EIP') return "Express Intercity Premium";
        if(cat === 'EIC') return "Express Intercity";
        if(cat === 'IC') return "Intercity";
        return "TLK";
    }

    function getTimeOfDay() {
        const h = new Date().getHours();
        if (h < 18) return "Dzie≈Ñ dobry!";
        return "Dobry wiecz√≥r!";
    }
    
    function getTimeOfDayEn() {
        const h = new Date().getHours();
        if (h < 12) return "Good morning!";
        if (h < 18) return "Good afternoon!";
        return "Good evening!";
    }

    // --- GENERATORY ZGODNE Z PDF ---

    // WZ√ìR NR 2 (Powitalny - Rozszerzony) - str. 8
    function generateWelcome() {
        const d = getData();
        let t = `${getTimeOfDay()}\n`;
        
        // 1. Powitanie i relacja
        let namePart = d.name ? ` "${d.name}"` : "";
        let viaPart = d.via ? `, przez stacjƒô ${d.via}` : "";
        t += `Witamy w pociƒÖgu ${d.catFull} numer ${d.nr}${namePart} ze stacji ${d.start} do stacji ${d.end}${viaPart}.\n\n`;

        // 2. Nastƒôpna stacja
        // (Wz√≥r 2 ma tu "Nastƒôpna stacja", ale w praktyce na starcie czƒôsto m√≥wi siƒô to po ruszeniu. 
        //  PDF m√≥wi: "za miastem, w kt√≥rym pociƒÖg rozpoczƒÖ≈Ç bieg". Wiƒôc dodajemy:)
        let nextSt = prompt("Podaj nazwƒô nastƒôpnej stacji (lub anuluj, by pominƒÖƒá):");
        if(nextSt) t += `Nastƒôpna stacja: ${nextSt}.\n\n`;

        // 3. Bezpiecze≈Ñstwo i Dru≈ºyna (OBOWIƒÑZKOWE we Wzorze 2)
        t += `W trosce o Pa≈Ñstwa komfort i bezpiecze≈Ñstwo, prosimy o zapoznanie siƒô z informacjami zamieszczonymi w wagonach.\n`;
        t += `Dru≈ºyna konduktorska pozostaje do Pa≈Ñstwa dyspozycji i s≈Çu≈ºy pomocƒÖ w trakcie ca≈Çej podr√≥≈ºy. `;
        t += `Przedzia≈Ç konduktorski znajduje siƒô w wagonie numer ${d.crewCar}.\n\n`;

        // 4. Gastronomia (Logika ze str. 9)
        if (d.gastroType === 'WARS') {
            t += `Zapraszamy do skorzystania z oferty gastronomicznej WARS, w wagonie numer ${d.gastroCar}.\n`;
        } else if (d.gastroType === 'VENDING') {
            t += `Zapraszamy do zakupu napoj√≥w i przekƒÖsek w automatach, w wagonie/wagonach numer ${d.gastroCar}.\n`;
        } else if (d.gastroType === 'TROLLEY') {
            t += `Zapraszamy do zakupu napoj√≥w i przekƒÖsek z w√≥zka mini-bar.\n`;
        } else {
            // "Je≈õli w pociƒÖgu oferta gastronomiczna nie jest dostƒôpna..."
            t += `Informujemy, ≈ºe w pociƒÖgu oferta gastronomiczna nie jest dostƒôpna, za co Pa≈Ñstwa przepraszamy.\n`;
        }

        // 5. Poczƒôstunek (tylko EIP/EIC czƒôsto, ale opcja w kodzie)
        // t += `W trakcie podr√≥≈ºy otrzymajƒÖ Pa≈Ñstwo poczƒôstunek.\n`; // Opcjonalne

        // ENGLISH (Wz√≥r 2 - str. 28)
        if (isEnglishRequired()) {
            t += `\n\n<div class="en-text">${getTimeOfDayEn()}\n`;
            
            let viaPartEn = d.via ? `, via ${d.via}` : "";
            t += `Welcome on board of our ${d.catFull} ${d.nr}${namePart} train from ${d.start} to ${d.end}${viaPartEn}.\n`;
            
            if(nextSt) t += `Next station ${nextSt}.\n`;
            
            t += `For your comfort and safety, please read the information provided in the passenger cars.\n`;
            t += `The on-board train crew remains at your service throughout the journey. `;
            t += `The train crew's compartment is located in the car number ${d.crewCar}.\n\n`;

            if (d.gastroType === 'WARS') {
                t += `We would like to invite you to try WARS' gastronomic service in car number ${d.gastroCar}.`;
            } else if (d.gastroType === 'NONE') {
                t += `Please be informed that the gastronomic service is not available in the train. We would like to apologize for this inconvenience.`;
            } else if (d.gastroType === 'TROLLEY') {
                t += `We would like to invite you to purchase drinks and snacks from the mini-bar cart.`;
            }
            t += `</div>`;
        }

        showModal(t);
    }

    // WZ√ìR NR 5 (Po≈ºegnalny) - str. 12
    function generateFarewell() {
        let text = `Zbli≈ºamy siƒô do stacji / stacji ko≈Ñcowej.\n`; // U≈ºytkownik czyta w≈Ça≈õciwe
        
        // Formu≈Çka 1:1 z PDF
        text += `Osoby wysiadajƒÖce prosimy o zabranie swoich rzeczy oraz zachowanie ostro≈ºno≈õci.\n`;
        text += `Dziƒôkujemy za podr√≥≈º z PKP Intercity.`;

        // ENGLISH (Wz√≥r 5 - str. 32)
        if (isEnglishRequired()) {
            text += `\n\n<div class="en-text">We are approaching the station / terminal station.\n`;
            text += `Passengers, who are leaving the train, please remember to take your belongings and take caution.\n`;
            text += `Thank you for choosing PKP Intercity.</div>`;
        }
        showModal(text);
    }

    // NASTƒòPNA STACJA (Standard z PDF - str. 10/30)
    function generateStation() {
        let st = prompt("Nazwa stacji:");
        if(!st) return;
        let t = `Nastƒôpna stacja: ${st}.`;
        if(isEnglishRequired()) {
            t += `\n\n<div class="en-text">Next station: ${st}.</div>`;
        }
        showModal(t);
    }

    // OP√ì≈πNIENIA (Wz√≥r A1 / Fragmenty powitalnego - str. 13/33)
    function openDelayMenu() {
        let min = prompt("Ile minut op√≥≈∫nienia?");
        if(!min) return;

        let code = prompt("Kod przyczyny:\n1-Tabor, 2-Drzwi, 3-Sieƒá, 4-Pogoda, 5-Wypadek(Osoba), 6-Przejazd, 7-Sterowanie, 8-Krzy≈ºowanie, 9-Inne");
        let reasonKey = "inne";
        if(code=="1") reasonKey="tabor";
        if(code=="2") reasonKey="drzwi";
        if(code=="3") reasonKey="siec";
        if(code=="4") reasonKey="pogoda";
        if(code=="5") reasonKey="wypadek_czlowiek";
        if(code=="6") reasonKey="wypadek_przejazd";
        if(code=="7") reasonKey="sterowanie";
        if(code=="8") reasonKey="skrzyzowanie";

        // PDF: "Informujemy, ≈ºe w zwiƒÖzku z [przyczyna] pociƒÖg jest op√≥≈∫niony o ... minuty/minut."
        // "Przepraszamy za op√≥≈∫nienie."
        let t = `Informujemy, ≈ºe w zwiƒÖzku z ${delayReasons[reasonKey]} pociƒÖg jest op√≥≈∫niony o ${min} minut.\n`;
        t += `Przepraszamy za op√≥≈∫nienie.`;
        
        // Dodatek o przesiadkach (czƒôsty w PDF przy op√≥≈∫nieniach)
        t += `\nOsoby przesiadajƒÖce siƒô do innych pociƒÖg√≥w prosimy o zg≈Çaszanie tego zamiaru dru≈ºynie konduktorskiej.`;

        if (isEnglishRequired()) {
            t += `\n\n<div class="en-text">We would like to inform you that due to ${delayReasonsEn[reasonKey]} the train is delayed about ${min} minutes.\n`;
            t += `We would like to apologize for the delay.\n`;
            t += `Passengers willing to change to connecting trains are asked to report this intention to the train crew.</div>`;
        }
        showModal(t);
    }

    // AWARIA (Wz√≥r B1 - Nieplanowany post√≥j - str. 15/35)
    function generateEmergency() {
        // PDF Sekwencja #1
        let t = `Informujemy, ≈ºe nastƒÖpi≈Ça nieprzewidziana przerwa w ruchu.\n`;
        t += `W chwili obecnej ustalamy przyczyny nieplanowego postoju pociƒÖgu.\n`;
        t += `Ze wzglƒôd√≥w bezpiecze≈Ñstwa, otwieranie drzwi wyj≈õciowych oraz opuszczanie pociƒÖgu jest zabronione.`;

        if (isEnglishRequired()) {
            t += `\n\n<div class="en-text">We would like to inform you about an unscheduled stop.\n`;
            t += `We are currently determining the causes of the unscheduled stop.\n`;
            t += `For safety reasons, opening the exit doors and leaving the train is prohibited.</div>`;
        }
        showModal(t);
    }

    // UI UTILS
    function showModal(html) {
        document.getElementById('outputText').innerHTML = html;
        document.getElementById('outputModal').classList.add('active');
    }
    function closeModal() {
        document.getElementById('outputModal').classList.remove('active');
    }
    
    // Inicjalizacja formularza
    updateGastroFields();
</script>

</body>
</html>