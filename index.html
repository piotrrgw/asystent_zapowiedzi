<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Generator Komunikat贸w PKP IC</title>
    <style>
        :root {
            --pkp-blue: #004d96;
            --pkp-orange: #f39200;
            --bg-color: #f4f4f9;
            --text-color: #333;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        h1 { font-size: 1.5rem; color: var(--pkp-blue); text-align: center; margin-bottom: 20px; }
        .container {
            width: 100%;
            max-width: 600px;
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        label { display: block; margin-top: 15px; font-weight: 600; font-size: 0.9rem; }
        input, select {
            width: 100%;
            padding: 12px;
            margin-top: 5px;
            border: 1px solid #ccc;
            border-radius: 8px;
            font-size: 1rem;
            box-sizing: border-box;
        }
        .btn-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 20px;
        }
        button {
            padding: 15px;
            background-color: var(--pkp-blue);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: background 0.2s;
        }
        button:active { background-color: #003366; }
        button.secondary { background-color: #6c757d; }
        
        .output-section { margin-top: 30px; border-top: 2px solid #eee; padding-top: 20px; }
        .output-box {
            background: #eef2f5;
            padding: 15px;
            border-left: 5px solid var(--pkp-orange);
            margin-bottom: 15px;
            white-space: pre-wrap;
        }
        .lang-label { font-size: 0.8rem; text-transform: uppercase; color: #888; margin-bottom: 5px; display: block; }
        .hidden { display: none; }
        .toast {
            background: #d4edda;
            color: #155724;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
            text-align: center;
            font-size: 0.9rem;
            display: none;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Asystent Kierownika Pocigu</h1>
        
        <div id="loadMsg" class="toast">伙 Wczytano ostatnie dane pocigu</div>

        <div id="setupStep">
            <label>Kategoria Pocigu:</label>
            <select id="trainCategory">
                <option value="EIP">Express Intercity Premium (EIP)</option>
                <option value="EIC">Express Intercity (EIC)</option>
                <option value="IC">Intercity (IC)</option>
                <option value="TLK">TLK</option>
            </select>

            <label>Numer pocigu (handlowy):</label>
            <input type="text" id="trainNumber" placeholder="np. 1305">

            <label>Stacja Docelowa:</label>
            <input type="text" id="destination" placeholder="np. Krak贸w G贸wny">

            <label>Przez (opcjonalnie):</label>
            <input type="text" id="viaStations" placeholder="np. Warszaw Centraln">

            <label>Gastronomia:</label>
            <select id="gastronomyType">
                <option value="wars">Wagon Restauracyjny (WARS)</option>
                <option value="vending">Tylko Automaty</option>
                <option value="wars_vending">WARS + Automaty</option>
                <option value="minibar">W贸zek Mini-bar</option>
                <option value="none">Brak oferty (awaryjnie)</option>
            </select>
            <input type="text" id="gastroCar" placeholder="Nr wagonu gastronomicznego (np. 14)" style="display:block;">

            <div class="btn-group">
                <button onclick="saveSetup()" style="grid-column: span 2;">Zatwierd藕 i Zapamitaj</button>
            </div>
        </div>

        <div id="generatorStep" class="hidden">
            <div style="text-align: right; margin-bottom: 10px;">
                <button class="secondary" onclick="editSetup()" style="padding: 5px 10px; font-size: 0.8rem;">Edytuj Dane</button>
            </div>

            <label>Wybierz sytuacj:</label>
            <select id="scenario" onchange="toggleScenarioFields()">
                <option value="welcome_start">Powitanie (Startowe - w miecie startu)</option>
                <option value="welcome_route">Powitanie (Na trasie - za stacj)</option>
                <option value="approaching">Zbli偶anie si do stacji</option>
                <option value="goodbye">Po偶egnanie (Stacja kocowa)</option>
            </select>

            <div id="stationInputSection">
                <label id="stationLabel">Aktualna/Poprzednia Stacja:</label>
                <input type="text" id="currentStation" placeholder="Wpisz nazw stacji..." oninput="checkAirport()">
                <small id="airportHint" style="color: var(--pkp-orange); font-weight: bold;"></small>
            </div>

            <div class="btn-group">
                <button onclick="generateAnnouncement()" style="grid-column: span 2;">Generuj Komunikat</button>
            </div>

            <div class="output-section">
                <span class="lang-label">Polski 叼</span>
                <div class="output-box" id="outputPL">...</div>
                
                <span class="lang-label">English </span>
                <div class="output-box" id="outputEN">...</div>
            </div>
        </div>
    </div>

<script>
    // --- BAZA WIEDZY ---
    
    // Lista miast wojew贸dzkich + Tr贸jmiasto [殴r贸do: str. 4, pkt 58]
    const voivodeshipCities = [
        "Biaystok", "Bydgoszcz", "Gdask", "Gorz贸w Wielkopolski", 
        "Katowice", "Kielce", "Krak贸w", "Lublin", "贸d藕", "Olsztyn", 
        "Opole", "Pozna", "Rzesz贸w", "Szczecin", "Toru", 
        "Warszawa", "Wrocaw", "Zielona G贸ra", 
        "Gdynia", "Sopot" 
    ];

    const airportConnections = {
        "Lublin G贸wny": { pl: "Portu Lotniczego Lublin", en: "Lublin AIRPORT" },
        "widnik Miasto": { pl: "Portu Lotniczego Lublin", en: "Lublin AIRPORT" },
        "Warszawa Wschodnia": { pl: "Lotniska Chopina w Warszawie i Portu Lotniczego Warszawa-Modlin", en: "Warszawa Lotnisko Chopina and Warszawa Modlin airports" },
        "Warszawa Zachodnia": { pl: "Lotniska Chopina w Warszawie i Portu Lotniczego Warszawa-Modlin", en: "Warszawa Lotnisko Chopina and Warszawa Modlin airports" },
        "Warszawa Centralna": { pl: "Lotniska Chopina w Warszawie i Portu Lotniczego Warszawa-Modlin", en: "Warszawa Lotnisko Chopina and Warszawa Modlin airports" },
        "Warszawa Gdaska": { pl: "Portu Lotniczego Warszawa-Modlin", en: "Modlin Airport" },
        "Katowice": { pl: "Portu Lotniczego Katowice-Pyrzowice", en: "Pyrzowice Lotnisko" },
        "Krak贸w G贸wny": { pl: "Portu Lotniczego Krak贸w-Balice", en: "Krak贸w Lotnisko" },
        "Rzesz贸w G贸wny": { pl: "Portu Lotniczego Rzesz贸w-Jasionka", en: "Jasionka Lotnisko" },
        "Gdask Wrzeszcz": { pl: "Portu Lotniczego Gdask", en: "Gdask Port Lotniczy" },
        "Gdynia G贸wna": { pl: "Portu Lotniczego Gdask", en: "Gdask Port Lotniczy" },
        "Olsztyn G贸wny": { pl: "Portu Lotniczego Olsztyn-Mazury", en: "Szymany Lotnisko" },
        "Szczecin Dbie": { pl: "Portu Lotniczego Szczecin Goleni贸w", en: "Port Lotniczy Szczecin Goleni贸w" }
    };

    let trainData = {};

    // --- LOGIKA APLIKACJI ---

    window.addEventListener('DOMContentLoaded', () => {
        const savedData = localStorage.getItem('pkp_train_data');
        if (savedData) {
            trainData = JSON.parse(savedData);
            document.getElementById('trainCategory').value = trainData.category || 'IC';
            document.getElementById('trainNumber').value = trainData.number || '';
            document.getElementById('destination').value = trainData.destination || '';
            document.getElementById('viaStations').value = trainData.via || '';
            document.getElementById('gastronomyType').value = trainData.gastroType || 'wars';
            document.getElementById('gastroCar').value = trainData.gastroCar || '';

            const msg = document.getElementById('loadMsg');
            msg.style.display = 'block';
            setTimeout(() => { msg.style.display = 'none'; }, 3000);
        }
        toggleScenarioFields();
    });

    function saveSetup() {
        trainData = {
            category: document.getElementById('trainCategory').value,
            number: document.getElementById('trainNumber').value,
            destination: document.getElementById('destination').value,
            via: document.getElementById('viaStations').value,
            gastroType: document.getElementById('gastronomyType').value,
            gastroCar: document.getElementById('gastroCar').value
        };
        localStorage.setItem('pkp_train_data', JSON.stringify(trainData));
        document.getElementById('setupStep').classList.add('hidden');
        document.getElementById('generatorStep').classList.remove('hidden');
        toggleScenarioFields();
    }

    function editSetup() {
        document.getElementById('setupStep').classList.remove('hidden');
        document.getElementById('generatorStep').classList.add('hidden');
    }

    function toggleScenarioFields() {
        const scenario = document.getElementById('scenario').value;
        const stationDiv = document.getElementById('stationInputSection');
        const label = document.getElementById('stationLabel');

        // Poka偶 pole stacji, bo jest potrzebne do okrelenia typu powitania
        stationDiv.classList.remove('hidden');

        if (scenario === 'welcome_route') {
            label.innerText = "Minlimy stacj (wpisz nazw):";
        } else if (scenario === 'welcome_start') {
            label.innerText = "Jestemy po ruszeniu ze stacji:";
        } else {
            label.innerText = "Zbli偶amy si do stacji:";
        }
    }

    function checkAirport() {
        const station = document.getElementById('currentStation').value;
        const match = Object.keys(airportConnections).find(key => key.toLowerCase() === station.toLowerCase());
        const hint = document.getElementById('airportHint');
        
        if (match) {
            hint.innerText = "锔 Wykryto przesiadk na lotnisko!";
        } else {
            hint.innerText = "";
        }
    }

    function getGastroText(lang) {
        const type = trainData.gastroType;
        const car = trainData.gastroCar || "...";
        
        if (lang === 'pl') {
            switch(type) {
                case 'wars': return `Zapraszamy do skorzystania z oferty gastronomicznej WARS, w wagonie numer ${car}.`;
                case 'vending': return `Zapraszamy do zakupu napoj贸w i przeksek w automatach, w wagonie/wagonach numer ${car}.`;
                case 'wars_vending': return `Zapraszamy do skorzystania z oferty gastronomicznej WARS, w wagonie numer ${car} oraz do zakupu napoj贸w i przeksek w automatach.`;
                case 'minibar': return `Zapraszamy do zakupu napoj贸w i przeksek z w贸zka mini-bar.`;
                case 'none': return `Informujemy, 偶e w pocigu oferta gastronomiczna nie jest dostpna, za co Pastwa przepraszamy.`;
                default: return "";
            }
        } else {
            switch(type) {
                case 'wars': return `We would like to invite you to try WARS' gastronomic service in car number ${car}.`;
                case 'vending': return `We would like to invite you to purchase drinks and snacks from the vending machines in car/cars number ${car}.`;
                case 'wars_vending': return `We would like to invite you to try WARS' gastronomic service in car number ${car} and to purchase drinks and snacks from the vending machines.`;
                case 'minibar': return `We would like to invite you to purchase drinks and snacks from the mini-bar cart.`;
                case 'none': return `Please be informed that the gastronomic service is not available in the train. We would like to apologize for this inconvenience.`;
                default: return "";
            }
        }
    }

    function generateAnnouncement() {
        const scenario = document.getElementById('scenario').value;
        const station = document.getElementById('currentStation').value.trim(); // Nazwa stacji
        let textPL = "";
        let textEN = "";

        // --- Logika Powita (zgodnie z list miast wojew贸dzkich) ---
        if (scenario === 'welcome_route') {
            // Sprawdzamy, czy stacja, kt贸r minlimy, jest wojew贸dzka
            // U偶ywamy .includes() aby sprawdzi obecno w tablicy
            const isVoivodeship = voivodeshipCities.includes(station);

            if (isVoivodeship) {
                // POWITALNY - ROZSZERZONY (Wz贸r 2) [殴r贸do: str. 8, pkt 152]
                const viaTextPL = trainData.via ? `, przez stacj ${trainData.via}` : "";
                const viaTextEN = trainData.via ? `, via ${trainData.via}` : "";
                
                textPL = `[POWITANIE ROZSZERZONE - bo "${station}" to miasto wojew贸dzkie]\n\nDzie dobry / Dobry wiecz贸r! \nWitamy w pocigu ${trainData.category} numer ${trainData.number} do stacji ${trainData.destination}${viaTextPL}.\n\nNastpna stacja: ...\n\n${getGastroText('pl')}\n\nW trosce o Pastwa komfort i bezpieczestwo, prosimy o zapoznanie si z informacjami zamieszczonymi w wagonach. Dru偶yna konduktorska pozostaje do Pastwa dyspozycji.`;
                
                textEN = `Good morning / Good evening! \nWelcome on board of our ${trainData.category} train ${trainData.number} to ${trainData.destination} station${viaTextEN}.\n\nNext station: ...\n\n${getGastroText('en')}\n\nFor your comfort and safety, please read the information provided in the passenger cars. The on-board train crew remains at your service.`;
            } else {
                // POWITALNY - SKRCONY (Wz贸r 3) [殴r贸do: str. 10, pkt 188]
                textPL = `[POWITANIE SKRCONE - bo "${station}" to inna miejscowo]\n\nNastpna stacja: ...\n\n${getGastroText('pl')}`;
                
                textEN = `Next station: ...\n\n${getGastroText('en')}`;
            }
        }
        else if (scenario === 'welcome_start') {
            // [殴r贸do: Wz贸r 1, str. 8, 28]
            textPL = `Nastpna stacja: ${trainData.destination}. \n\n(Jeli gastronomia): Zapraszamy do skorzystania z oferty gastronomicznej.`;
            textEN = `Next station: ${trainData.destination}. \n\nWe would like to invite you to try the gastronomic service.`;
        }
        else if (scenario === 'approaching') {
             textPL = `Zbli偶amy si do stacji ${station}.`;
             textEN = `We are approaching ${station} station.`;
             
             const airport = Object.keys(airportConnections).find(key => key.toLowerCase() === station.toLowerCase());
             if (airport) {
                 textPL += `\n\nZe stacji ${station} odje偶d偶aj pocigi w kierunku ${airportConnections[airport].pl}. Prosimy o zwr贸cenie uwagi na informacje stacyjne.`;
                 textEN += `\n\nFrom ${station} station depart trains to ${airportConnections[airport].en}. Please be reminded to pay attention to information provided at the station.`;
             }
             
             textPL += `\n\nOsoby wysiadajce prosimy o zabranie swoich rzeczy oraz zachowanie ostro偶noci. Dzikujemy za podr贸偶 z PKP Intercity.`;
             textEN += `\n\nPassengers who are leaving the train, please remember to take your belongings and take caution. Thank you for choosing PKP Intercity.`;
        }
        else if (scenario === 'goodbye') {
             textPL = `Zbli偶amy si do stacji kocowej ${station}. Dzikujemy za podr贸偶 z PKP Intercity.`;
             textEN = `We are approaching terminal station ${station}. Thank you for choosing PKP Intercity.`;
        }

        document.getElementById('outputPL').innerText = textPL;
        document.getElementById('outputEN').innerText = textEN;
    }
</script>
</body>
</html>